<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link rel="stylesheet" type="text/css" href="../../../static/css/aui.min.css"/>
		<title>生成二维码</title>
		<style>
			body{background: #FFF;}
			.content{width: 100%; padding: 15px; box-sizing: border-box;}
			.input-warp{width: 100%; font-size: 0; margin-top: 40px;}
			#text{width: -webkit-calc(100% - 70px); width: calc(100% - 70px); height: 50px; background: #F4F4F4; border-radius: 10px 0 0 10px; display: inline-block; vertical-align: middle;}
			#text:after{border-radius: 20px 0 0 20px;}
			#text input{width: 100%; height: 100%; font-size: 14px; padding: 0 15px; box-sizing: border-box; border: none; background: transparent; position: relative; z-index: 2;}			
			.aui-btn{width: 70px; height: 50px; margin: 0 0 0 0; text-align: center; background: var(--aui-blue); border-radius: 0px 10px 10px 0px; color: #FFF; display: inline-block; vertical-align: middle;}
			.aui-btn span{display: inline-block; vertical-align: top;}
			.aui-loading-main{border-radius: 0 10px 10px 0;}
			.qrcode{width: 100%; height: -webkit-calc(100vw - 30px); height: calc(100vw - 30px); display: inline-block; position: relative;}
			.qrcode img,.qrcode canvas{width: 70%; height: 70%; background: #F4F4F4; border-radius: 10px; position: absolute; top: 15%; left: 15%;}
		</style>
	</head>
	<body>		
	    <div class="container" id="app">
			<header class="aui-header">
				<a class="aui-header-left" onclick="aui.closeWin()"><i class="iconfont iconreturn"></i></a>
				<div class="aui-header-title">生成二维码</div>
			</header>
	    	<div class="content" v-cloak  style="padding: 15px 15px 0 15px;">				
	    		<div class="input-warp">
	    			<div id="text" class="border">
	    				<input type="" name="" id="" v-model="text" placeholder="请输入网址链接或其他文字内容" value="" />					
	    			</div>	
	    			<div class="aui-btn" @click.stop="submitFn()"><span>生成</span></div>
	    		</div>	    		
	    		<div class="qrcode">
	    			<img class="qrcode-img" src="" alt="">
	    		</div>
	    	</div>
	    </div>
		<script type="text/javascript" charset="utf-8" src="https://res.wx.qq.com/open/js/jweixin-1.4.0.js"></script>
	    <script type="text/javascript" src="../../../lib/vue.min.js"></script>
	    <script type="text/javascript" src="../../../lib/jquery/jquery-2.1.3.min.js"></script>
		<script type="text/javascript" src="../../../lib/qrcode/jquery.qrcode.js"></script>
		<script type="text/javascript" src="../../../lib/utf/utf.js"></script>
	    <script type="text/javascript" src="../../../static/js/aui.min.js"></script>
	   	<script type="text/javascript">
	   		window.onload = function(){				
	   			apiready();
	   		}
	   		apiready = function() {
	   			var vm = new Vue({
	   				el: "#app",
	   				data: {	
						text: '',
	   					qrcode: ''
	   				},
	   				created: function(){
	   					var _this = this;
						
	   				},
	   				mounted: function() {
	   					var _this = this;	
	   						
	   	            },
	   	            updated: function () {
	   	                var _this = this;
	   	                _this.$nextTick(function () {
	   		
	   	                })
	   	            },
	   	            methods: {							   								
						//生成二维码
						submitFn(){
							var _this = this;																				
							aui.showload({warp: '.aui-btn', type: 2, msg: ''}, function(){
								aui.hideload();
								if(!aui.isDefine(_this.text)){aui.toast({msg: '请输入网址链接或其他文字内容'}); return;}
								//生成二维码
								var qrcode = $(".qrcode").qrcode({
									render: "canvas",
									text: _this.text,
									width : "400",             //二维码的宽度
									height : "400",            //二维码的高度
									background : "#ffffff",    //二维码的后景色
									foreground : "#000000",    //二维码的前景色
									src: '../../../static/img/image/logo.png' //二维码中间的图片
								});								
								var canvas = qrcode.find('canvas').get(0);
								$('.qrcode-img').attr('src', canvas.toDataURL('image/png')).css({
								    maxWidth:300
								});
							});
						},
	   	            }
	   			});
	   		}
	   	</script>
	</body>
</html>
